FROM python:3.8-bullseye

RUN wget https://github.com.cnpmjs.org/golang-migrate/migrate/releases/download/v4.15.1/migrate.linux-amd64.tar.gz -O migrate.linux-amd64.tar.gz
RUN tar -xvf migrate.linux-amd64.tar.gz -C /usr/local/bin
RUN chmod a+x /usr/local/bin/migrate

RUN chmod a+x /root/migrate.sh

CMD ["/wait-for-it/wait-for-it.sh", "douban-crawler-db:5432", "--", "/root/migrate.sh"]
